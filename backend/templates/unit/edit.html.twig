{% extends 'base.html.twig' %}
{% block title %}√âditer {{ suite.name }}{% endblock %}
{% block body %}
<h1 class="mb-3">√âditer le test: {{ suite.name }}</h1>
{{ form_start(form) }}
  <div class="mb-3">
    <label class="form-label">Nom du test</label>
    <div class="input-group input-group-sm mb-1">
      <span class="input-group-text">üß™</span>
      {{ form_widget(form.name, { attr: { id: 'ub-name', class: 'form-control form-control-sm' } }) }}
    </div>
    <div class="form-text">Nom lisible du test (s'affiche en gras dans la liste).</div>
  </div>

  <div class="mb-3">
    <label class="form-label">Dossier</label>
    <div class="input-group input-group-sm mb-1">
      <span class="input-group-text">üìÅ</span>
      {{ form_widget(form.folder, { attr: { id: 'ub-folder', class: 'form-select form-select-sm' } }) }}
    </div>
    <div class="form-text">Regroupe visuellement les tests (badge).</div>
  </div>
  <div class="mb-3">
    <label class="form-label d-flex align-items-center justify-content-between">
      <span>D√©finition des tests (JSON)</span>
      <span class="d-flex gap-2">
        <button type="button" class="btn btn-sm btn-outline-secondary" id="exampleTestsBtn" title="Ins√©rer un exemple de tests (temps & co√ªt)"><i class="bi bi-lightning"></i> Exemple</button>
        <button type="button" class="btn btn-sm btn-outline-primary" id="aiHttpBtn"><i class="bi bi-magic"></i> IA: proposer des tests</button>
      </span>
    </label>
    {{ form_widget(form.testsJson) }}
  </div>
  <button class="btn btn-primary">Enregistrer</button>
  <a href="{{ path('unit_show', {id: suite.id}) }}" class="btn btn-secondary">Retour</a>
{{ form_end(form) }}
<div class="modal modal-overlay" tabindex="-1" id="aiHttpModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">IA: g√©n√©rer des tests HTTP</h5>
        <button type="button" class="btn-close" id="aiHttpClose"></button>
      </div>
      <div class="modal-body">
        <label class="form-label">D√©crivez les endpoints √† tester</label>
        <textarea id="aiHttpPrompt" class="form-control" rows="5" placeholder="Ex: Tester GET / renvoie 200 et contient 'Accueil'. Tester POST /api/login avec JSON {email, password} renvoie 200."></textarea>
        <div class="form-text">Incluez les chemins, m√©thodes et assertions attendues.</div>
        <div id="aiHttpError" class="text-danger small d-none mt-2"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="aiHttpCancel">Annuler</button>
        <button type="button" class="btn btn-primary" id="aiHttpGenerate">G√©n√©rer</button>
      </div>
    </div>
  </div>
  {# JS moved to /js/pages/unit.js #}
{% endblock %}
